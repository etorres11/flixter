<script>
   $(function() {
    $('.lessons').sortable({
      update: function( event, ui ) {
          $.ajax({
            type: 'PUT',
            url: ui.item.data('update-url'),
            dataType: 'json',
            data: { lesson: { row_order_position: ui.item.index()}}

          });
      }
    });


    $('.sections').sortable({
      update: function( event, ui ) {
          $.ajax({
            type: 'PUT',
            url: ui.item.data('update-url'),
            dataType: 'json',
            data: { lesson: { row_order_position: ui.item.index()}}

          });
      }
    });



  });
</script>

<br>
<div class="booyah-box col-10 offset-1">
  <h1 class="text-center"><%= current_course.title %></h1>
  <%= image_tag current_course.image_url.to_s, class: 'img-fluid' %> 

  <br class="clr">
  <div class="text-center">
  <%= link_to 'Preview as Student...', course_path(current_course), class: 'btn btn-warning' %>
  </div>
  <br class="clr">
  <div class="text-center">
    <%= link_to 'Add a New Section...', new_instructor_course_section_path(current_course), class: 'btn btn-primary btn-lg' %>

  </div>
  <br class="clr">
  <br>
  <ul class='sections'>
    <% current_course.sections.rank(:row_order).each do |section| %>
    <li data-update-url="<%=new_instructor_section_lesson_path(section)%>">
      <%= section.title %>
      <ul class='lessons'>
        <% section.lessons.rank(:row_order).each do |lesson| %>
        <li data-update-url="<%= instructor_lesson_path(lesson) %>">
          <b><%= lesson.title %></b>

          -

          <%= lesson.subtitle %>
        </li>
        <% end %>
      </ul>
      <br class='clr'>
    </li>
    <% end %>
  </ul>


</div>
